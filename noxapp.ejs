<% for(var model in models) { %>
var <%= model %>Model = Backbone.Model.extend({
  __model_name : '<%= model %>',
});

var <%= model %>Collection = Backbone.Collection.extend({
  __name : '<%= model %>s',
  __model_name : '<%= model %>',
  __model: <%= model %>Model,
  __list_display: [<% for(var i in models[model].__list_display) {%>'<%= models[model].__list_display[i] %>',<%} %>]
});<% } %>
<% for(var model in models) { %>
var <%=: model | downcase %>Collection = new <%= model %>Collection();<% } %>

var ModelView = Backbone.View.extend({
  el: "#content",
  initialize: function(){
  },
  link : function(model){
    this.model = model;
  },
  render: function(id){
    //var compiledTemplate = _.template( 'This is : '+this.model.__model_name+','+id,{});
    $(this.el).html('This is : '+this.model.__model_name+','+id);
    Backbone.ModelBinding.bind(this);
  }
});
var modelView = new ModelView();

var CollectionView = Backbone.View.extend({
  el: "#content",
  initialize: function(){
  },
  link : function(collection){
    this.collection = collection;
  },
  render: function(){
    $(this.el).html(require('ejs').render($('#list_view').html(), { headings:this.collection.__list_display,items:this.collection.models,model_name:this.collection.__model_name  }));
    //$(this.el).html(_.template( $('#list_template').html(), {}  ));
    //var compiledTemplate = _.template( 'This is : '+this.model.name+'s');
    //$(this.el).html('This is '+this.collection.__name+' a collection of '+this.collection.__model_name);
    //Backbone.ModelBinding.bind(this);
  }
});
var collectionView = new CollectionView();

authorCollection.add(new AuthorModel({id:0,name:'Edgar Alan',surname:'Poe'}));
authorCollection.add(new AuthorModel({id:1,name:'Ernest',surname:'Hemingway'}));


var Router = Backbone.Router.extend({
  routes: {
    <% for(var model in models) { %>
    '/<%= model %>/:id'  : 'show<%= model %>',
    '/<%= model %>s'     : 'show<%= model %>s',<% } %>
    '*actions': 'defaultAction'
  },
  <% for(var model in models) { %>
  show<%= model %> : function(pid){
    alert('<%= model %> - '+pid);  
    modelView.link(new <%= model %>Model());
    modelView.render(pid);
  },
  show<%= model %>s : function(){
    //alert('<%= model %>s'); 
    collectionView.link(<%=: model | downcase %>Collection);
    collectionView.render();  
  },<% } %>
  defaultAction: function(actions){
    alert('No route: ' + [actions,'hallo']);  
    console.log('No route:', [actions,'hallo']);
  }
});

var router = new Router();
Backbone.history.start();

